# Office-Addin-Manifest-Converter

This package provides the ability to convert an XML manifest to JSON manifest for Office add-ins. 

## Command-Line Interface

### convert

Convert the Office add-in manifest from XML format to JSON format.

Syntax:

`office-addin-manifest-converter convert <xml-manifest-file> [options]`

Parameter:

`xml-manifest-file`: path to the XML manifest file.

Options:

`-o <string>` or `--output <string>`

Specify the path to an output directory that will contain the generated JSON manifest and related files. If there is no output directory specified, the default directory will have the same name as the input file's base name and be located at the same place of the input file. For example, if the input XML file is _C:\xmlManifests\myAddin.xml_, the default output directory will be _C:\xmlManifests\myAddin_.

`-i` or `--image-download`

Specify that the conversion should download the root images color and outline into the output directory.

`-v` or `--verbose`

Specify that extra log messages should be written to console.

`--schema-override <url>`

The url that property $schema will be set to. Default is the latest public version schema that the converter supports. $schema and manifestVersion (set with --schema-version-override parameter) properties should be in sync.

`--schema-version-override <version>`

The version string that property manifestVersion will be set to. Default is the latest public version that the converter supports (ie \"1.17\" etc). $schema (set with --schema-override parameter) and manifestVersion properties should be in sync.

Example:

After the package has been installed globally, the following command converts the an XML manifest file, _C:\xmlManifests\myAddin.xml_, to json manifest and puts the converted files into _C:\jsonManifests\myAddin_ directory.

`office-addin-manifest-converter convert C:\xmlManifests\myAddin.xml -o C:\jsonManifests\myAddin -iv`

In the command, both `verbose` and `image-download` flags are turned on.


## API Usage

This package provides an API called `convert`. The API takes two required parameters and two optional ones:

```js
convert(inputXmlManifestFile: string, outputJsonManifestFolder: string, imageDownload: boolean = false, verbose: boolean = false);
```

`inputXmlManifestFile`: path of the input XML manifest file. 

`outputJsonManifestFolder`: path of the output folder that will contain all generated files, including one JSON manifest file and a few icon files.

`imageDownload`: whether the conversion should download the images into the output directory.

`verbose`: whether extra log messages should be written to console.

The following example converts an XML manifest file, _C:\xmlManifests\myAddin.xml_, to json manifest and puts the converted files into _C:\jsonManifests\myAddin_ folder.

```js
var converter = require("office-addin-manifest-converter");

converter.convert("C:/xmlManifests/myAddin.xml", "C:/jsonManifests/myAddin", true, false);
```

## Versions

0.4.1 - Fix bug for converting four part version format "0.0.0.0" to the three part format used in json manifest ("0.0.0") as specified by https://semver.org/.

0.4.1 - Add support for devpreview ReportPhishingCommandSurface extension point.
