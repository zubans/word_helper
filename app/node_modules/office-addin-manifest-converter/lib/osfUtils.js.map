{"version":3,"file":"osfUtils.js","sourceRoot":"","sources":["../src/osfUtils.ts"],"names":[],"mappings":"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","sourcesContent":["import { OSF, OfficeExt } from \"../lib/osfmos\";\nimport { DOMParser } from \"@xmldom/xmldom\";\n\n// Some part of the below code is copied from file %SRCROOT%\\osfjs\\shared_src\\jscript\\officeutil\\msajaxbase.ts and %SRCROOT%\\osfjs\\shared_src\\jscript\\XmlUtil.ts\n// This is to override the internal implementation to use the 'xmldom' npm package for XML parsing. It is not required to keep it sync with the osf files\n// But we might need to update it if there is new methods added to these files in order to parse XML.\n\n/// <summary>\n/// DomParser Provider\n/// </summary>\n/// <param name=\"xmldoc\">xml string</param>\n/// <param name=\"xmlNamespaces\">namespaces</param>\n/// <accessibility>private</accessibility>\nexport module Utils {\n  export function validateParams(params, expectedParams, ParameterCount?): any {\n    var e,\n      expectedLength = expectedParams.length;\n    ParameterCount = ParameterCount || typeof ParameterCount === \"undefined\";\n    e = validateParameterCount(params, expectedParams, ParameterCount);\n    if (e) {\n      return e;\n    }\n    for (var i = 0, l = params.length; i < l; i++) {\n      var expectedParam = expectedParams[Math.min(i, expectedLength - 1)],\n        paramName = expectedParam.name;\n      if (expectedParam.parameterArray) {\n        paramName += \"[\" + (i - expectedLength + 1) + \"]\";\n      } else if (!ParameterCount && i >= expectedLength) {\n        break;\n      }\n      e = validateParameter(params[i], expectedParam, paramName);\n      if (e) {\n        e.popStackFrame();\n        return e;\n      }\n    }\n    return null;\n  }\n\n  export function validateParameter(param, expectedParam, paramName): any {\n    var e,\n      expectedType = expectedParam.type,\n      expectedInteger = !!expectedParam.integer,\n      expectedDomElement = !!expectedParam.domElement,\n      mayBeNull = !!expectedParam.mayBeNull;\n    e = validateParameterType(param, expectedType, expectedInteger, expectedDomElement, mayBeNull, paramName);\n    if (e) {\n      e.popStackFrame();\n      return e;\n    }\n    var expectedElementType = expectedParam.elementType,\n      elementMayBeNull = !!expectedParam.elementMayBeNull;\n    if (\n      expectedType === Array &&\n      typeof param !== \"undefined\" &&\n      param !== null &&\n      (expectedElementType || !elementMayBeNull)\n    ) {\n      var expectedElementInteger = !!expectedParam.elementInteger,\n        expectedElementDomElement = !!expectedParam.elementDomElement;\n      for (var i = 0; i < param.length; i++) {\n        var elem = param[i];\n        e = validateParameterType(\n          elem,\n          expectedElementType,\n          expectedElementInteger,\n          expectedElementDomElement,\n          elementMayBeNull,\n          paramName + \"[\" + i + \"]\",\n        );\n        if (e) {\n          e.popStackFrame();\n          return e;\n        }\n      }\n    }\n    return null;\n  }\n\n  export function validateParameterCount(params, expectedParams, validateParameterCount): any {\n    var i,\n      error,\n      expectedLen = expectedParams.length,\n      actualLen = params.length;\n    if (actualLen < expectedLen) {\n      var minParams = expectedLen;\n      for (i = 0; i < expectedLen; i++) {\n        var param = expectedParams[i];\n        if (param.optional || param.parameterArray) {\n          minParams--;\n        }\n      }\n      if (actualLen < minParams) {\n        error = true;\n      }\n    } else if (validateParameterCount && actualLen > expectedLen) {\n      error = true;\n      for (i = 0; i < expectedLen; i++) {\n        if (expectedParams[i].parameterArray) {\n          error = false;\n          break;\n        }\n      }\n    }\n    if (error) {\n      var e = OfficeExt.MsAjaxError.parameterCount();\n      return e;\n    }\n    return null;\n  }\n\n  export function validateParameterType(\n    param,\n    expectedType,\n    expectedInteger,\n    expectedDomElement,\n    mayBeNull,\n    paramName,\n  ) {\n    var e, i;\n    if (typeof param === \"undefined\") {\n      if (mayBeNull) {\n        return null;\n      } else {\n        e = OfficeExt.MsAjaxError.argumentUndefined(paramName);\n        e.popStackFrame();\n        return e;\n      }\n    }\n    if (param === null) {\n      if (mayBeNull) {\n        return null;\n      } else {\n        e = OfficeExt.MsAjaxError.argumentNull(paramName);\n        e.popStackFrame();\n        return e;\n      }\n    }\n    if (expectedType && !OfficeExt.MsAjaxTypeHelper.isInstanceOfType(expectedType, param)) {\n      e = OfficeExt.MsAjaxError.argumentType(paramName, typeof param, expectedType);\n      e.popStackFrame();\n      return e;\n    }\n    return null;\n  }\n\n  export function getDomainForUrl(url) {\n    if (!url) {\n      return null;\n    }\n    var urlObject = OSF.OUtil.parseUrl(url, /*enforceHttps*/ true);\n    return urlObject.protocol + \"//\" + urlObject.host;\n  }\n\n  // Use this method to override the Osf Methods\n  export function OverrideMethods() {\n    OSF.XmlProcessor = XmlProcessor;\n    OfficeExt.WACUtils.getDomainForUrl = Utils.getDomainForUrl;\n  }\n}\n\nexport class DomParserProvider {\n  _defaultNamespace: any;\n  _namespaceMapping: any;\n  _xmldoc: any;\n  constructor(xml, xmlNamespaces) {\n    try {\n      this._xmldoc = new DOMParser({}).parseFromString(xml, \"text/xml\");\n    } catch (ex) {\n      console.trace(\"xml doc creating error:\" + ex);\n    }\n    // handle namespace\n    this._namespaceMapping = {};\n    this._defaultNamespace = null;\n    var namespaces = xmlNamespaces.split(\" \");\n    var matches;\n    for (var i = 0; i < namespaces.length; ++i) {\n      matches = /xmlns=\"([^\"]*)\"/g.exec(namespaces[i]);\n      if (matches) {\n        this._defaultNamespace = matches[1];\n        continue;\n      }\n      matches = /xmlns:([^=]*)=\"([^\"]*)\"/g.exec(namespaces[i]);\n      if (matches) {\n        this._namespaceMapping[matches[1]] = matches[2];\n        continue;\n      }\n    }\n  }\n\n  addNamespaceMapping(namespacePrefix, namespaceUri) {\n    var ns = this._namespaceMapping[namespacePrefix];\n    if (ns) {\n      return false; // The namespace prefix is already defined\n    } else {\n      this._namespaceMapping[namespacePrefix] = namespaceUri;\n      return true;\n    }\n  }\n  getNamespaceMapping(): any {\n    return this._namespaceMapping;\n  }\n  selectSingleNode(name, contextNode) {\n    var selectedNode = contextNode || this._xmldoc;\n    var nodes = this._selectNodes(name, selectedNode);\n    if (nodes.length === 0) return null;\n    return nodes[0];\n  }\n  selectNodes(name, contextNode) {\n    var selectedNode = contextNode || this._xmldoc;\n    return this._selectNodes(name, selectedNode);\n  }\n  selectNodesByXPath(xpath, contextNode) {\n    // Todo(OfficeVSO:81193): Try to support selectNodesByXPath in DomParserProvider.\n    return null;\n  }\n  _selectNodes(name, contextNode) {\n    var nodes = [];\n    if (!name) return nodes;\n    var nameInfo = name.split(\":\");\n    var ns, nodeName;\n    if (nameInfo.length === 1) {\n      ns = null;\n      nodeName = nameInfo[0];\n    } else if (nameInfo.length === 2) {\n      ns = this._namespaceMapping[nameInfo[0]];\n      nodeName = nameInfo[1];\n    } else {\n      throw OfficeExt.MsAjaxError.argument(\"name\");\n    }\n    if (!contextNode.hasChildNodes) return nodes;\n    var childs = contextNode.childNodes;\n    for (var i = 0; i < childs.length; i++) {\n      if (nodeName === this._removeNodePrefix(childs[i].nodeName) && ns === childs[i].namespaceURI) {\n        nodes.push(childs[i]);\n      }\n    }\n    return nodes;\n  }\n  _removeNodePrefix(nodeName) {\n    if (!nodeName) return null;\n\n    var nodeInfo = nodeName.split(\":\");\n    if (nodeInfo.length === 1) {\n      return nodeName;\n    } else {\n      return nodeInfo[1];\n    }\n  }\n  getDocumentElement() {\n    return this._xmldoc.documentElement;\n  }\n}\n\n/// <summary>\n/// XmlProcessor, cross browser XML parsing.\n/// </summary>\n/// <param name=\"xml\">xml string</param>\n/// <param name=\"xmlNamespaces\">xml Namespaces string</param>\n/// <accessibility>public</accessibility>\nexport class XmlProcessor {\n  _provider: any;\n  constructor(xml, xmlNamespaces) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"xml\", type: String, mayBeNull: false },\n      { name: \"xmlNamespaces\", type: String, mayBeNull: false },\n    ]);\n    if (e) throw e;\n    // IMPORTANT!! CODE CHANGE[begin]\n    this._provider = new DomParserProvider(xml, xmlNamespaces);\n    // IMPORTANT!! CODE CHANGE[end]\n  }\n\n  addNamespaceMapping(namespacePrefix, namespaceUri) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"namespacePrefix\", type: String, mayBeNull: false },\n      { name: \"namespaceUri\", type: String, mayBeNull: false },\n    ]);\n    if (e) throw e;\n    return this._provider.addNamespaceMapping(namespacePrefix, namespaceUri);\n  }\n\n  /// <summary>\n  /// Get the namespace mapping\n  /// </summary>\n  getNamespaceMapping(): any {\n    return this._provider?.getNamespaceMapping();\n  }\n\n  /// <summary>\n  /// select a single node\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"name\">XML node name</param>\n  /// <returns>XML DOM Node object.</returns>\n  selectSingleNode(name, contextNode) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"name\", type: String, mayBeNull: false },\n      { name: \"contextNode\", mayBeNull: true, optional: true },\n    ]);\n    if (e) throw e;\n    return this._provider.selectSingleNode(name, contextNode);\n  }\n\n  /// <summary>\n  /// select all child nodes that match node name\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"name\">XML node name</param>\n  /// <returns>array of XML DOM Node objects.</returns>\n  selectNodes(name, contextNode) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"name\", type: String, mayBeNull: false },\n      { name: \"contextNode\", mayBeNull: true, optional: true },\n    ]);\n    if (e) throw e;\n    return this._provider.selectNodes(name, contextNode);\n  }\n\n  /// <summary>\n  /// select nodes that match the xpath query\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"xpath\">xpath string</param>\n  /// <returns>array of XML DOM Node objects.</returns>\n  selectNodesByXPath(xpath, contextNode) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"xpath\", type: String, mayBeNull: false },\n      { name: \"contextNode\", mayBeNull: true, optional: true },\n    ]);\n    if (e) throw e;\n    contextNode = contextNode || this._provider.getDocumentElement();\n    return this._provider.selectNodesByXPath(xpath, contextNode);\n  }\n\n  /// <summary>\n  /// get root document element\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM root document element</param>\n  /// <returns>value of the node as string</returns>\n  getDocumentElement() {\n    return this._provider.getDocumentElement();\n  }\n\n  /// <summary>\n  /// get node value\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <returns>value of the node as string</returns>\n  getNodeValue(node) {\n    var e = Utils.validateParams(arguments, [{ name: \"node\", type: Object, mayBeNull: false }]);\n    if (e) throw e;\n    var nodeValue;\n    if (node.text) {\n      //IE\n      nodeValue = node.text;\n    } else {\n      //others\n      nodeValue = node.textContent;\n    }\n    return nodeValue;\n  }\n\n  /// <summary>\n  /// get node text\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <returns>text of the node as string</returns>\n  getNodeText(node) {\n    var e = Utils.validateParams(arguments, [{ name: \"node\", type: Object, mayBeNull: false }]);\n    if (e) throw e;\n    if (this.getNodeType(node) == 9) {\n      //Handle special case for document node.\n      //For document node on Chrome and Edge, the text and textContent of the node are both null.\n      //Return the text of the document element here.\n      return this.getNodeText(this.getDocumentElement());\n    }\n    var nodeText;\n    if (node.text) {\n      //IE\n      nodeText = node.text;\n    } else {\n      //others\n      nodeText = node.textContent;\n    }\n    return nodeText;\n  }\n\n  /// <summary>\n  /// set node text\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <param name=\"text\">text be set to the node</param>\n  /// <returns>True if text is set succesfully</returns>\n  setNodeText(node, text) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"node\", type: Object, mayBeNull: false },\n      { name: \"text\", type: String, mayBeNull: false },\n    ]);\n    if (e) throw e;\n    if (this.getNodeType(node) == 9) {\n      //Handle special case for document node.\n      //For document node on Chrome and Edge, the text and textContent of the node are both null.\n      //As the text for document node cannot be set, return false here.\n      return false;\n    }\n    try {\n      if (node.text) {\n        //IE\n        node.text = text;\n      } else {\n        //others\n        node.textContent = text;\n      }\n    } catch (ex) {\n      return false;\n    }\n    return true;\n  }\n\n  /// <summary>\n  /// get node xml\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <returns>xml of the node as string</returns>\n  getNodeXml(node) {\n    var e = Utils.validateParams(arguments, [{ name: \"node\", type: Object, mayBeNull: false }]);\n    if (e) throw e;\n    var nodeXml;\n    if (node.xml) {\n      //IE\n      nodeXml = node.xml;\n    } else {\n      //Others\n      nodeXml = new XMLSerializer().serializeToString(node);\n      if (this.getNodeType(node) == 2) {\n        // Handle special case for attribute node.\n        nodeXml = this.getNodeBaseName(node) + '=\"' + nodeXml + '\"';\n      }\n    }\n    return nodeXml;\n  }\n\n  /// <summary>\n  /// set node xml\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <param name=\"xml\">xml be set to the node</param>\n  /// <returns>new node after the xml set</returns>\n  setNodeXml(node, xml) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"node\", type: Object, mayBeNull: false },\n      { name: \"xml\", type: String, mayBeNull: false },\n    ]);\n    if (e) throw e;\n    var processor = new OSF.XmlProcessor(xml, \"\");\n    if (!processor.isValidXml()) {\n      return null;\n    }\n    var newNode = processor.getDocumentElement();\n    try {\n      node.parentNode.replaceChild(newNode, node);\n    } catch (ex) {\n      return null;\n    }\n    return newNode;\n  }\n\n  /// <summary>\n  /// get node namespaceURI\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <returns>namespaceURI of the node as string</returns>\n  getNodeNamespaceURI(node) {\n    var e = Utils.validateParams(arguments, [{ name: \"node\", type: Object, mayBeNull: false }]);\n    if (e) throw e;\n    return node.namespaceURI;\n  }\n\n  /// <summary>\n  /// get node prefix\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <returns>prefix of the node as string</returns>\n  getNodePrefix(node) {\n    var e = Utils.validateParams(arguments, [{ name: \"node\", type: Object, mayBeNull: false }]);\n    if (e) throw e;\n    return node.prefix;\n  }\n\n  /// <summary>\n  /// get node baseName\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <returns>baseName of the node as string</returns>\n  getNodeBaseName(node) {\n    var e = Utils.validateParams(arguments, [{ name: \"node\", type: Object, mayBeNull: false }]);\n    if (e) throw e;\n    var nodeBaseName;\n    // localName: http://www.w3schools.com/xml/prop_node_localname.asp\n    // nodename: http://www.w3schools.com/xml/prop_node_nodename.asp\n    // baseName: https://msdn.microsoft.com/en-us/library/ms767570(v=vs.85).aspx\n    if (node.nodeType && (node.nodeType == 1 || node.nodeType == 2)) {\n      // For element node and attribute node, use the baseName (IE) or localName (Others)\n      if (node.baseName) {\n        //IE\n        nodeBaseName = node.baseName;\n      } else {\n        //others\n        nodeBaseName = node.localName;\n      }\n    } else {\n      // For other nodetype, use nodeName as the basename\n      nodeBaseName = node.nodeName;\n    }\n    return nodeBaseName;\n  }\n\n  /// <summary>\n  /// get node type\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <returns>type of the node as int</returns>\n  getNodeType(node) {\n    var e = Utils.validateParams(arguments, [{ name: \"node\", type: Object, mayBeNull: false }]);\n    if (e) throw e;\n    return node.nodeType;\n  }\n\n  /// <summary>\n  /// append child node with child xml\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <param name=\"childXml\">child xml be appended to the node</param>\n  /// <returns>new child node after the xml appended</returns>\n  appendChild(node, childXml) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"node\", type: Object, mayBeNull: false },\n      { name: \"childXml\", type: String, mayBeNull: false },\n    ]);\n    if (e) throw e;\n    var processor = new OSF.XmlProcessor(childXml, \"\");\n    if (!processor.isValidXml()) {\n      return null;\n    }\n    var childNode = processor.getDocumentElement();\n    node.appendChild(childNode);\n    return childNode;\n  }\n\n  /// <summary>\n  /// get node value\n  /// </summary>\n  /// <accessibility>private</accessibility>\n  /// <param name=\"attribute\">DOM attribute object</param>\n  /// <returns>value of the node as string</returns>\n  _getAttributeLocalName(attribute) {\n    var localName;\n    if (attribute.localName) {\n      //non IE\n      localName = attribute.localName;\n    } else {\n      //IE\n      localName = attribute.baseName;\n    }\n    return localName;\n  }\n\n  /// <summary>\n  /// read attributes to fill the object\n  /// </summary>\n  /// <accessibility>public</accessibility>\n  /// <param name=\"node\">DOM element object</param>\n  /// <param name=\"attributesToRead\">attributes to read</param>\n  /// <param name=\"objectToFill\">object to fill with attribute values</param>\n  readAttributes(node, attributesToRead, objectToFill) {\n    var e = Utils.validateParams(arguments, [\n      { name: \"node\", type: Object, mayBeNull: false },\n      { name: \"attributesToRead\", type: Object, mayBeNull: false },\n      { name: \"objectToFill\", type: Object, mayBeNull: false },\n    ]);\n    if (e) throw e;\n    var attribute;\n    var localName;\n    for (var i = 0; i < node.attributes.length; i++) {\n      attribute = node.attributes[i];\n      localName = this._getAttributeLocalName(attribute);\n      for (var p in attributesToRead) {\n        if (localName === p) {\n          objectToFill[attributesToRead[p]] = attribute.value;\n        }\n      }\n    }\n  }\n\n  /// <summary>\n  /// Identify whether the xml string passed to the processor is valid\n  /// </summary>\n  isValidXml() {\n    var documentElement = this.getDocumentElement();\n    if (documentElement == null) {\n      return false;\n    } else if (this._provider._xmldoc.getElementsByTagName(\"parsererror\").length > 0) {\n      var parser = new DOMParser();\n      var errorParse = parser.parseFromString(\"<\", \"text/xml\");\n      var parseErrorNS = errorParse.getElementsByTagName(\"parsererror\")[0].namespaceURI;\n      return this._provider._xmldoc.getElementsByTagNameNS(parseErrorNS, \"parsererror\").length <= 0;\n    }\n    return true;\n  }\n}\n"]}